-- ---------------------
-- ADVANCED UNIVERSAL CHEATS
-- ---------------------

-- Fly toggle + speed slider
local flyEnabled = false
local flySpeed = 80
local flyVel = nil

createToggle(universalSec,"Fly",false,function(enabled)
    flyEnabled = enabled
    if not enabled and flyVel and flyVel.Parent then
        flyVel:Destroy()
        flyVel = nil
    end
end)

createSlider(universalSec,"Fly Speed",50,500,80,function(v)
    flySpeed = v
end)

-- Noclip toggle
local noclipEnabled = false
createToggle(universalSec,"Noclip",false,function(enabled)
    noclipEnabled = enabled
end)

-- Fly/Noclip logic
RunService.RenderStepped:Connect(function()
    local char = player.Character
    if char then
        local hrp = char:FindFirstChild("HumanoidRootPart")
        local hum = char:FindFirstChildOfClass("Humanoid")
        if hrp and hum then
            -- Noclip
            if noclipEnabled then
                for _, part in ipairs(char:GetDescendants()) do
                    if part:IsA("BasePart") then
                        part.CanCollide = false
                    end
                end
            end

            -- Fly
            if flyEnabled then
                if not flyVel or not flyVel.Parent then
                    flyVel = Instance.new("BodyVelocity")
                    flyVel.MaxForce = Vector3.new(1e5,1e5,1e5)
                    flyVel.Velocity = Vector3.new(0,0,0)
                    flyVel.Parent = hrp
                end
                local dir = Vector3.new()
                if UserInputService:IsKeyDown(Enum.KeyCode.W) then dir = dir + workspace.CurrentCamera.CFrame.LookVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.S) then dir = dir - workspace.CurrentCamera.CFrame.LookVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.A) then dir = dir - workspace.CurrentCamera.CFrame.RightVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.D) then dir = dir + workspace.CurrentCamera.CFrame.RightVector end
                if dir.Magnitude > 0.1 then
                    flyVel.Velocity = dir.Unit * flySpeed
                else
                    flyVel.Velocity = Vector3.new(0,0,0)
                end
            elseif flyVel and flyVel.Parent then
                flyVel:Destroy()
                flyVel = nil
            end
        end
    end
end)
