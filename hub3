-- ‚öôÔ∏è Auto Hub Script (All Features + Emergency Stop)
local Player = game.Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")

-- destroy old hub if running
if PlayerGui:FindFirstChild("AutoHub") then
    PlayerGui.AutoHub:Destroy()
end

-- ‚úÖ Shared states
getgenv().AutoStates = {
    Mining = false,
    Wheel = false,
    AutoWin = false,
    Rewards = {},
    Eggs = {},
    Teleport = false
}

-- remotes
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Remotes = ReplicatedStorage:WaitForChild("Remotes")
local EggsRemote = Remotes:WaitForChild("Eggs")
local WheelRemote = Remotes:WaitForChild("Wheel")
local PlaytimeRemote = Remotes:WaitForChild("Playtime")
local GameHandler = Remotes:WaitForChild("GameHandler")

-- gui setup
local gui = Instance.new("ScreenGui")
gui.Name = "AutoHub"
gui.ResetOnSpawn = false
gui.Parent = PlayerGui

local mainFrame = Instance.new("Frame", gui)
mainFrame.Size = UDim2.new(0, 520, 0, 380)
mainFrame.Position = UDim2.new(0.5, -260, 0.5, -190)
mainFrame.BackgroundColor3 = Color3.fromRGB(40,40,40)
mainFrame.Active = true
mainFrame.Draggable = true

local tabFrame = Instance.new("Frame", mainFrame)
tabFrame.Size = UDim2.new(0, 120, 1, 0)
tabFrame.BackgroundColor3 = Color3.fromRGB(30,30,30)

local contentFrame = Instance.new("Frame", mainFrame)
contentFrame.Size = UDim2.new(1, -120, 1, 0)
contentFrame.Position = UDim2.new(0, 120, 0, 0)
contentFrame.BackgroundColor3 = Color3.fromRGB(25,25,25)

local function round(obj,r) Instance.new("UICorner",obj).CornerRadius = UDim.new(0,r) end

-- make tab button
local function makeTabButton(name, callback)
    local btn = Instance.new("TextButton", tabFrame)
    btn.Size = UDim2.new(1, -10, 0, 40)
    btn.Position = UDim2.new(0, 5, 0, (#tabFrame:GetChildren()-1)*45 + 10)
    btn.Text = name
    btn.Font = Enum.Font.SourceSansBold
    btn.TextSize = 16
    btn.BackgroundColor3 = Color3.fromRGB(88,101,242)
    btn.TextColor3 = Color3.new(1,1,1)
    round(btn,8)
    btn.MouseButton1Click:Connect(callback)
end

-- ü™ì Mining Tab
local function buildMiningTab()
    for _,v in pairs(contentFrame:GetChildren()) do v:Destroy() end
    local btn = Instance.new("TextButton", contentFrame)
    btn.Size = UDim2.new(0,200,0,40)
    btn.Position = UDim2.new(0.5,-100,0.5,-20)
    btn.Text = "Mining OFF"
    btn.Font = Enum.Font.SourceSansBold
    btn.TextSize = 16
    btn.BackgroundColor3 = Color3.fromRGB(88,101,242)
    btn.TextColor3 = Color3.new(1,1,1)
    round(btn,8)

    btn.MouseButton1Click:Connect(function()
        AutoStates.Mining = not AutoStates.Mining
        btn.Text = "Mining "..(AutoStates.Mining and "ON" or "OFF")
        btn.BackgroundColor3 = AutoStates.Mining and Color3.fromRGB(0,170,0) or Color3.fromRGB(88,101,242)
        if AutoStates.Mining then
            task.spawn(function()
                while AutoStates.Mining do
                    local args = {{Info="Mine"}}
                    pcall(function() GameHandler:FireServer(unpack(args)) end)
                    task.wait(0.2)
                end
            end)
        end
    end)
end

-- ü•ö Eggs Tab
local function buildEggsTab()
    for _,v in pairs(contentFrame:GetChildren()) do v:Destroy() end
    local eggs = {"Egg 1","Egg 2","Egg 3","Egg 4","Egg 5","Egg 6","Egg 7","Egg 8","Egg 9","Egg 10","Egg 11","Egg 12","Egg 13","Egg 14","Egg 15"}

    local grid = Instance.new("UIGridLayout", contentFrame)
    grid.CellSize = UDim2.new(0, 120, 0, 40)
    grid.CellPadding = UDim2.new(0, 10, 0, 10)
    grid.SortOrder = Enum.SortOrder.LayoutOrder

    for _,eggName in ipairs(eggs) do
        AutoStates.Eggs[eggName] = false
        local btn = Instance.new("TextButton", contentFrame)
        btn.Text = eggName.." OFF"
        btn.Font = Enum.Font.SourceSansBold
        btn.TextSize = 14
        btn.BackgroundColor3 = Color3.fromRGB(88,101,242)
        btn.TextColor3 = Color3.new(1,1,1)
        round(btn,6)

        btn.MouseButton1Click:Connect(function()
            AutoStates.Eggs[eggName] = not AutoStates.Eggs[eggName]
            btn.Text = eggName.." "..(AutoStates.Eggs[eggName] and "ON" or "OFF")
            btn.BackgroundColor3 = AutoStates.Eggs[eggName] and Color3.fromRGB(0,170,0) or Color3.fromRGB(88,101,242)

            if AutoStates.Eggs[eggName] then
                task.spawn(function()
                    while AutoStates.Eggs[eggName] do
                        local args = {{Info="PurchaseEgg", Egg=eggName}}
                        pcall(function() EggsRemote:InvokeServer(unpack(args)) end)
                        task.wait(0.15)
                    end
                end)
            end
        end)
    end
end

-- üé° Wheel Tab
local function buildWheelTab()
    for _,v in pairs(contentFrame:GetChildren()) do v:Destroy() end
    local btn = Instance.new("TextButton", contentFrame)
    btn.Size = UDim2.new(0,200,0,40)
    btn.Position = UDim2.new(0.5,-100,0.5,-20)
    btn.Text = "Wheel OFF"
    btn.Font = Enum.Font.SourceSansBold
    btn.TextSize = 16
    btn.BackgroundColor3 = Color3.fromRGB(88,101,242)
    btn.TextColor3 = Color3.new(1,1,1)
    round(btn,8)

    btn.MouseButton1Click:Connect(function()
        AutoStates.Wheel = not AutoStates.Wheel
        btn.Text = "Wheel "..(AutoStates.Wheel and "ON" or "OFF")
        btn.BackgroundColor3 = AutoStates.Wheel and Color3.fromRGB(0,170,0) or Color3.fromRGB(88,101,242)
        if AutoStates.Wheel then
            task.spawn(function()
                while AutoStates.Wheel do
                    pcall(function() WheelRemote:InvokeServer() end)
                    task.wait(5)
                end
            end)
        end
    end)
end

-- üéÅ Rewards Tab
local function buildRewardsTab()
    for _,v in pairs(contentFrame:GetChildren()) do v:Destroy() end
    local grid = Instance.new("UIGridLayout", contentFrame)
    grid.CellSize = UDim2.new(0, 120, 0, 40)
    grid.CellPadding = UDim2.new(0, 10, 0, 10)
    grid.SortOrder = Enum.SortOrder.LayoutOrder

    for reward = 1,9 do
        AutoStates.Rewards[reward] = false
        local btn = Instance.new("TextButton", contentFrame)
        btn.Text = "Reward "..reward.." OFF"
        btn.Font = Enum.Font.SourceSansBold
        btn.TextSize = 14
        btn.BackgroundColor3 = Color3.fromRGB(88,101,242)
        btn.TextColor3 = Color3.new(1,1,1)
        round(btn,6)

        btn.MouseButton1Click:Connect(function()
            AutoStates.Rewards[reward] = not AutoStates.Rewards[reward]
            btn.Text = "Reward "..reward.." "..(AutoStates.Rewards[reward] and "ON" or "OFF")
            btn.BackgroundColor3 = AutoStates.Rewards[reward] and Color3.fromRGB(0,170,0) or Color3.fromRGB(88,101,242)

            if AutoStates.Rewards[reward] then
                task.spawn(function()
                    while AutoStates.Rewards[reward] do
                        local args = {{Info="ClaimReward", Reward=reward}}
                        pcall(function() PlaytimeRemote:FireServer(unpack(args)) end)
                        task.wait(10)
                    end
                end)
            end
        end)
    end
end

-- üåç Teleport Tab
local function buildTeleportTab()
    for _,v in pairs(contentFrame:GetChildren()) do v:Destroy() end
    local worlds = {"World 1","World 2","World 3","World 4","World 5"}
    local grid = Instance.new("UIGridLayout", contentFrame)
    grid.CellSize = UDim2.new(0, 140, 0, 40)
    grid.CellPadding = UDim2.new(0, 10, 0, 10)
    grid.SortOrder = Enum.SortOrder.LayoutOrder

    for i,world in ipairs(worlds) do
        local btn = Instance.new("TextButton", contentFrame)
        btn.Text = world
        btn.Font = Enum.Font.SourceSansBold
        btn.TextSize = 14
        btn.BackgroundColor3 = Color3.fromRGB(88,101,242)
        btn.TextColor3 = Color3.new(1,1,1)
        round(btn,6)

        btn.MouseButton1Click:Connect(function()
            local args = {{Info="SwitchWorld", World=i}}
            pcall(function() GameHandler:FireServer(unpack(args)) end)
        end)
    end
end

-- üèÜ Auto-Win Tab
local function buildAutoWinTab()
    for _,v in pairs(contentFrame:GetChildren()) do v:Destroy() end
    local btn = Instance.new("TextButton", contentFrame)
    btn.Size = UDim2.new(0,200,0,40)
    btn.Position = UDim2.new(0.5,-100,0.5,-20)
    btn.Text = "Auto-Win OFF"
    btn.Font = Enum.Font.SourceSansBold
    btn.TextSize = 16
    btn.BackgroundColor3 = Color3.fromRGB(88,101,242)
    btn.TextColor3 = Color3.new(1,1,1)
    round(btn,8)

    btn.MouseButton1Click:Connect(function()
        AutoStates.AutoWin = not AutoStates.AutoWin
        btn.Text = "Auto-Win "..(AutoStates.AutoWin and "ON" or "OFF")
        btn.BackgroundColor3 = AutoStates.AutoWin and Color3.fromRGB(0,170,0) or Color3.fromRGB(88,101,242)
        if AutoStates.AutoWin then
            task.spawn(function()
                while AutoStates.AutoWin do
                    local args = {{Info="CollectWin"}}
                    pcall(function() GameHandler:FireServer(unpack(args)) end)
                    task.wait(5)
                end
            end)
        end
    end)
end

-- üö® Emergency Stop
local function stopAll()
    for k,_ in pairs(AutoStates.Rewards) do AutoStates.Rewards[k] = false end
    for k,_ in pairs(AutoStates.Eggs) do AutoStates.Eggs[k] = false end
    AutoStates.Mining, AutoStates.Wheel, AutoStates.Teleport, AutoStates.AutoWin = false,false,false,false
    print("‚ö†Ô∏è Emergency Stop pressed: all automation halted")
end

-- tab buttons
makeTabButton("Mining", buildMiningTab)
makeTabButton("Eggs", buildEggsTab)
makeTabButton("Wheel", buildWheelTab)
makeTabButton("Rewards", buildRewardsTab)
makeTabButton("Teleport", buildTeleportTab)
makeTabButton("Auto-Win", buildAutoWinTab)
makeTabButton("‚ö†Ô∏è Stop", stopAll)

-- default tab
buildMiningTab()
