-- Clean Hub Full Script
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local player = Players.LocalPlayer
local guiParent = CoreGui

-- Sizes
local CLOSED_SZ = UDim2.new(0,1,0,1)
local HUB_SZ = UDim2.new(0,700,0,450)
local MINIMIZED_SZ = UDim2.new(0,200,0,40)

-- Tween helper
local tweenInfo = TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
local function tween(obj, props)
    local tw = TweenService:Create(obj, tweenInfo, props)
    tw:Play()
    return tw
end

local function round(ui, radius)
    local c = Instance.new("UICorner", ui)
    c.CornerRadius = UDim.new(0, radius or 8)
end

-- ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "CleanHubGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = guiParent

-- Main Frame
local frame = Instance.new("Frame", screenGui)
frame.Size = HUB_SZ
frame.Position = UDim2.new(0.5,0,0.5,0)
frame.AnchorPoint = Vector2.new(0.5,0.5)
frame.BackgroundColor3 = Color3.fromRGB(20,20,20)
frame.Active = true
frame.BorderSizePixel = 0
round(frame,10)

-- Dragging
local dragging, dragInput, dragStart, startPos
UserInputService.InputChanged:Connect(function(input)
    if input==dragInput and dragging then
        local delta = input.Position - dragStart
        frame.Position = UDim2.new(
            startPos.X.Scale, startPos.X.Offset+delta.X,
            startPos.Y.Scale, startPos.Y.Offset+delta.Y
        )
    end
end)

local function enableDrag(target)
    target.InputBegan:Connect(function(i)
        if i.UserInputType==Enum.UserInputType.MouseButton1 or i.UserInputType==Enum.UserInputType.Touch then
            dragging = true
            dragStart = i.Position
            startPos = frame.Position
            i.Changed:Connect(function()
                if i.UserInputState==Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    target.InputChanged:Connect(function(i)
        if i.UserInputType==Enum.UserInputType.MouseMovement or i.UserInputType==Enum.UserInputType.Touch then
            dragInput = i
        end
    end)
end

-- Top Bar
local bar=Instance.new("Frame",frame)
bar.Size=UDim2.new(1,0,0,40)
bar.Position=UDim2.new(0,0,0,0)
bar.BackgroundColor3=Color3.fromRGB(40,40,40)
bar.Active=true
round(bar,10)
enableDrag(bar)

local title=Instance.new("TextLabel",bar)
title.Size=UDim2.new(1,-120,1,0)
title.Position=UDim2.new(0,10,0,0)
title.BackgroundTransparency=1
title.Font=Enum.Font.SourceSansBold
title.TextSize=24
title.Text="Clean Hub"
title.TextColor3=Color3.new(1,1,1)
title.TextXAlignment=Enum.TextXAlignment.Left

local closeBtn=Instance.new("TextButton",bar)
closeBtn.Size=UDim2.new(0,30,0,30)
closeBtn.Position=UDim2.new(1,-40,0,5)
closeBtn.Text="X"
closeBtn.Font=Enum.Font.SourceSansBold
closeBtn.TextSize=18
closeBtn.BackgroundColor3=Color3.fromRGB(200,50,50)
closeBtn.TextColor3=Color3.new(1,1,1)
round(closeBtn,4)

local minBtn=Instance.new("TextButton",bar)
minBtn.Size=UDim2.new(0,30,0,30)
minBtn.Position=UDim2.new(1,-80,0,5)
minBtn.Text="-"
minBtn.Font=Enum.Font.SourceSansBold
minBtn.TextSize=22
minBtn.BackgroundColor3=Color3.fromRGB(100,100,100)
minBtn.TextColor3=Color3.new(1,1,1)
round(minBtn,4)

-- Tabs + Content
local tabsFrame=Instance.new("Frame",frame)
tabsFrame.Size=UDim2.new(0,140,1,-60)
tabsFrame.Position=UDim2.new(0,0,0,50)
tabsFrame.BackgroundTransparency=1

local contentFrame=Instance.new("Frame",frame)
contentFrame.Size=UDim2.new(1,-140,1,-60)
contentFrame.Position=UDim2.new(0,140,0,50)
contentFrame.BackgroundTransparency=1
enableDrag(contentFrame)

local tabNames={"Mining","Spin Wheel","Rewards","Eggs","Auto Win","Teleport"}
local tabButtons={}

-- Mining Tab
local function buildMiningTab()
    for _,v in pairs(contentFrame:GetChildren()) do v:Destroy() end
    local label = Instance.new("TextLabel", contentFrame)
    label.Size = UDim2.new(0.6,-10,0,30)
    label.Position = UDim2.new(0,10,0,10)
    label.BackgroundTransparency = 1
    label.Text = "Auto Mine"
    label.TextColor3 = Color3.new(1,1,1)
    label.Font = Enum.Font.SourceSansBold
    label.TextSize = 18
    label.TextXAlignment = Enum.TextXAlignment.Left

    local mineBtn = Instance.new("TextButton", contentFrame)
    mineBtn.Size = UDim2.new(0.35,0,0,30)
    mineBtn.Position = UDim2.new(0.65,0,0,10)
    mineBtn.Text = "OFF"
    mineBtn.Font = Enum.Font.SourceSansBold
    mineBtn.TextSize = 18
    mineBtn.BackgroundColor3 = Color3.fromRGB(88,101,242)
    mineBtn.TextColor3 = Color3.new(1,1,1)
    round(mineBtn,6)

    local mining = false
    local Remote = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("GameHandler")
    local mineArgs = {{Info="Mine"}}

    local function startMining()
        while mining do
            pcall(function()
                Remote:FireServer(unpack(mineArgs))
            end)
            task.wait(0.1)
        end
    end

    mineBtn.MouseButton1Click:Connect(function()
        mining = not mining
        mineBtn.Text = mining and "ON" or "OFF"
        mineBtn.BackgroundColor3 = mining and Color3.fromRGB(0,170,0) or Color3.fromRGB(88,101,242)
        if mining then task.spawn(startMining) end
    end)
end

-- Spin Wheel Tab
local function buildSpinTab()
    for _,v in pairs(contentFrame:GetChildren()) do v:Destroy() end
    local label = Instance.new("TextLabel", contentFrame)
    label.Size = UDim2.new(0.6,-10,0,30)
    label.Position = UDim2.new(0,10,0,10)
    label.BackgroundTransparency = 1
    label.Text = "Auto Spin Wheel"
    label.TextColor3 = Color3.new(1,1,1)
    label.Font = Enum.Font.SourceSansBold
    label.TextSize = 18
    label.TextXAlignment = Enum.TextXAlignment.Left

    local spinBtn = Instance.new("TextButton", contentFrame)
    spinBtn.Size = UDim2.new(0.35,0,0,30)
    spinBtn.Position = UDim2.new(0.65,0,0,10)
    spinBtn.Text = "OFF"
    spinBtn.Font = Enum.Font.SourceSansBold
    spinBtn.TextSize = 18
    spinBtn.BackgroundColor3 = Color3.fromRGB(88,101,242)
    spinBtn.TextColor3 = Color3.new(1,1,1)
    round(spinBtn,6)

    local spinning = false
    local Remote = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("Wheel")

    spinBtn.MouseButton1Click:Connect(function()
        spinning = not spinning
        spinBtn.Text = spinning and "ON" or "OFF"
        spinBtn.BackgroundColor3 = spinning and Color3.fromRGB(0,170,0) or Color3.fromRGB(88,101,242)
        if spinning then
            task.spawn(function()
                while spinning do
                    pcall(function()
                        Remote:InvokeServer()
                    end)
                    task.wait(1)
                end
            end)
        end
    end)
end

-- Rewards Tab
local function buildRewardsTab()
    for _,v in pairs(contentFrame:GetChildren()) do v:Destroy() end
    local Remote = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("Playtime")

    for i=1,9 do
        local btn = Instance.new("TextButton", contentFrame)
        btn.Size = UDim2.new(0.9,0,0,30)
        btn.Position = UDim2.new(0.05,0,0,(i-1)*40 + 10)
        btn.Text = "Auto Collect Reward "..i
        btn.Font = Enum.Font.SourceSansBold
        btn.TextSize = 18
        btn.BackgroundColor3 = Color3.fromRGB(88,101,242)
        btn.TextColor3 = Color3.new(1,1,1)
        round(btn,6)
        local active = false

        btn.MouseButton1Click:Connect(function()
            active = not active
            btn.BackgroundColor3 = active and Color3.fromRGB(0,170,0) or Color3.fromRGB(88,101,242)
            btn.Text = (active and "ON " or "OFF ").."Reward "..i
            if active then
                task.spawn(function()
                    while active do
                        pcall(function()
                            Remote:FireServer({{Info="ClaimReward",Reward=i}})
                        end)
                        task.wait(1)
                    end
                end)
            end
        end)
    end
end

-- Egg Tab
local function buildEggTab()
    for _,v in pairs(contentFrame:GetChildren()) do v:Destroy() end

    -- Label
    local label = Instance.new("TextLabel", contentFrame)
    label.Size = UDim2.new(0.6, -10, 0, 30)
    label.Position = UDim2.new(0, 10, 0, 10)
    label.BackgroundTransparency = 1
    label.Text = "Auto-Buy Egg"
    label.TextColor3 = Color3.new(1,1,1)
    label.Font = Enum.Font.SourceSansBold
    label.TextSize = 18
    label.TextXAlignment = Enum.TextXAlignment.Left

    -- Egg dropdown (simple TextButton cycle)
    local eggList = {}
    for i=1,20 do
        table.insert(eggList, "Egg "..i)
    end
    local selectedEgg = eggList[1]

    local dropdown = Instance.new("TextButton", contentFrame)
    dropdown.Size = UDim2.new(0.35, 0, 0, 30)
    dropdown.Position = UDim2.new(0.65, 0, 0, 10)
    dropdown.Text = selectedEgg
    dropdown.Font = Enum.Font.SourceSansBold
    dropdown.TextSize = 16
    dropdown.BackgroundColor3 = Color3.fromRGB(88,101,242)
    dropdown.TextColor3 = Color3.new(1,1,1)
    round(dropdown,6)

    dropdown.MouseButton1Click:Connect(function()
        -- cycle to next egg
        for i,v in ipairs(eggList) do
            if v == selectedEgg then
                selectedEgg = eggList[i % #eggList + 1]
                break
            end
        end
        dropdown.Text = selectedEgg
    end)

    -- Toggle Button
    local toggleBtn = Instance.new("TextButton", contentFrame)
    toggleBtn.Size = UDim2.new(0.2,0,0,30)
    toggleBtn.Position = UDim2.new(0.65, 0, 0, 50)
    toggleBtn.Text = "OFF"
    toggleBtn.Font = Enum.Font.SourceSansBold
    toggleBtn.TextSize = 18
    toggleBtn.BackgroundColor3 = Color3.fromRGB(88,101,242)
    toggleBtn.TextColor3 = Color3.new(1,1,1)
    round(toggleBtn,6)

    local buying = false
    toggleBtn.MouseButton1Click:Connect(function()
        buying = not buying
        toggleBtn.Text = buying and "ON" or "OFF"
        toggleBtn.BackgroundColor3 = buying and Color3.fromRGB(0,170,0) or Color3.fromRGB(88,101,242)
    end)

    -- Auto-buy loop
    local Remote = game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("Eggs")
    task.spawn(function()
        while true do
            if buying then
                pcall(function()
                    Remote:InvokeServer({{Info="PurchaseEgg", Egg=selectedEgg}})
                end)
                task.wait(0.1) -- adjust speed if needed
            else
                task.wait(1)
            end
        end
    end)
end


    buyBtn.MouseButton1Click:Connect(function()
        if not activeEgg then return end -- require egg selected
        buying = not buying
        buyBtn.Text = buying and "ON" or "OFF"
        buyBtn.BackgroundColor3 = buying and Color3.fromRGB(0,170,0) or Color3.fromRGB(88,101,242)
        if buying then
            task.spawn(function()
                while buying do
                    pcall(function()
                        Remote:InvokeServer({{Info="PurchaseEgg",Egg=activeEgg}})
                    end)
                    task.wait(1)
                end
            end)
        end
    end)
end


-- Auto Win Tab
local function buildWinTab()
    for _,v in pairs(contentFrame:GetChildren()) do v:Destroy() end
    local Remote = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("GameHandler")
    local btn = Instance.new("TextButton", contentFrame)
    btn.Size = UDim2.new(0.9,0,0,30)
    btn.Position = UDim2.new(0.05,0,0,10)
    btn.Text = "Auto Win OFF"
    btn.Font = Enum.Font.SourceSansBold
    btn.TextSize = 18
    btn.BackgroundColor3 = Color3.fromRGB(88,101,242)
    btn.TextColor3 = Color3.new(1,1,1)
    round(btn,6)

    local active = false
    btn.MouseButton1Click:Connect(function()
        active = not active
        btn.BackgroundColor3 = active and Color3.fromRGB(0,170,0) or Color3.fromRGB(88,101,242)
        btn.Text = (active and "Auto Win ON" or "Auto Win OFF")
        if active then
            task.spawn(function()
                while active do
                    pcall(function()
                        Remote:FireServer({{Info="CollectWin"}})
                    end)
                    task.wait(0.5)
                end
            end)
        end
    end)
end

-- Teleport Tab
local function buildTeleportTab()
    for _,v in pairs(contentFrame:GetChildren()) do v:Destroy() end
    local Remote = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("GameHandler")
    local worlds = 5
    local spacing = 40
    for i=1,worlds do
        local btn = Instance.new("TextButton", contentFrame)
        btn.Size = UDim2.new(0.9,0,0,30)
        btn.Position = UDim2.new(0.05,0,0,(i-1)*spacing+10)
        btn.Text = "Go to World "..i
        btn.Font = Enum.Font.SourceSansBold
        btn.TextSize = 18
        btn.BackgroundColor3 = Color3.fromRGB(88,101,242)
        btn.TextColor3 = Color3.new(1,1,1)
        round(btn,6)
        btn.MouseButton1Click:Connect(function()
            pcall(function()
                Remote:FireServer({{Info="SwitchWorld",World=i}})
            end)
        end)
    end
end

-- Tab Switch
local function selectTab(idx)
    for i,btn in ipairs(tabButtons) do
        btn.BackgroundColor3 = (i==idx) and Color3.fromRGB(80,80,80) or Color3.fromRGB(50,50,50)
    end
    if idx==1 then buildMiningTab()
    elseif idx==2 then buildSpinTab()
    elseif idx==3 then buildRewardsTab()
    elseif idx==4 then buildEggTab()
    elseif idx==5 then buildWinTab()
    elseif idx==6 then buildTeleportTab()
    end
end

-- Create Tab Buttons
for i,name in ipairs(tabNames) do
    local btn = Instance.new("TextButton", tabsFrame)
    btn.Size = UDim2.new(1,0,0,40)
    btn.Position = UDim2.new(0,0,0,(i-1)*45)
    btn.Text = name
    btn.Font = Enum.Font.SourceSansBold
    btn.TextSize = 20
    round(btn,6)
    btn.BackgroundColor3 = (i==1 and Color3.fromRGB(80,80,80) or Color3.fromRGB(50,50,50))
    btn.TextColor3 = Color3.new(1,1,1)
    btn.MouseButton1Click:Connect(function() selectTab(i) end)
    table.insert(tabButtons,btn)
end

-- Select first tab
selectTab(1)

-- Minimize + Close
local minimized=false
minBtn.MouseButton1Click:Connect(function()
    minimized = not minimized
    tween(frame,{Size=minimized and MINIMIZED_SZ or HUB_SZ})
    tabsFrame.Visible = not minimized
    contentFrame.Visible = not minimized
end)

closeBtn.MouseButton1Click:Connect(function()
    tween(frame,{Size=CLOSED_SZ}).Completed:Wait()
    screenGui:Destroy()
end)
