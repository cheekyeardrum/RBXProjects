-- Clean Hub with Multiple Tabs
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local player = Players.LocalPlayer
local guiParent = CoreGui

-- Remote references
local GameHandler = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("GameHandler")
local WheelRemote = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("Wheel")
local PlaytimeRemote = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("Playtime")
local EggsRemote = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("Eggs")

-- Sizes
local CLOSED_SZ = UDim2.new(0,1,0,1)
local HUB_SZ = UDim2.new(0,700,0,450)
local MINIMIZED_SZ = UDim2.new(0,200,0,40)

-- Tween helper
local tweenInfo = TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
local function tween(obj, props)
    local tw = TweenService:Create(obj, tweenInfo, props)
    tw:Play()
    return tw
end

local function round(ui, radius)
    local c = Instance.new("UICorner", ui)
    c.CornerRadius = UDim.new(0, radius or 8)
end

-- ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "CleanHubGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = guiParent

-- Main Frame
local frame = Instance.new("Frame", screenGui)
frame.Name = "MainFrame"
frame.Size = HUB_SZ
frame.Position = UDim2.new(0.5,0,0.5,0)
frame.AnchorPoint = Vector2.new(0.5,0.5)
frame.BackgroundColor3 = Color3.fromRGB(20,20,20)
frame.Active = true
frame.BorderSizePixel = 0
round(frame,10)

-- Dragging
local dragging, dragInput, dragStart, startPos
UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        local delta = input.Position - dragStart
        frame.Position = UDim2.new(
            startPos.X.Scale, startPos.X.Offset + delta.X,
            startPos.Y.Scale, startPos.Y.Offset + delta.Y
        )
    end
end)

local function enableDrag(target)
    target.InputBegan:Connect(function(i)
        if i.UserInputType==Enum.UserInputType.MouseButton1 or i.UserInputType==Enum.UserInputType.Touch then
            dragging = true
            dragStart = i.Position
            startPos = frame.Position
            i.Changed:Connect(function()
                if i.UserInputState==Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    target.InputChanged:Connect(function(i)
        if i.UserInputType==Enum.UserInputType.MouseMovement or i.UserInputType==Enum.UserInputType.Touch then
            dragInput = i
        end
    end)
end

-- Top Bar
local bar = Instance.new("Frame", frame)
bar.Size = UDim2.new(1,0,0,40)
bar.Position = UDim2.new(0,0,0,0)
bar.BackgroundColor3 = Color3.fromRGB(40,40,40)
bar.Active = true
round(bar,10)
enableDrag(bar)

local title = Instance.new("TextLabel", bar)
title.Size = UDim2.new(1,-120,1,0)
title.Position = UDim2.new(0,10,0,0)
title.BackgroundTransparency = 1
title.Font = Enum.Font.SourceSansBold
title.TextSize = 24
title.Text = "Clean Hub"
title.TextColor3 = Color3.new(1,1,1)
title.TextXAlignment = Enum.TextXAlignment.Left

local closeBtn = Instance.new("TextButton", bar)
closeBtn.Size = UDim2.new(0,30,0,30)
closeBtn.Position = UDim2.new(1,-40,0,5)
closeBtn.Text = "X"
closeBtn.Font = Enum.Font.SourceSansBold
closeBtn.TextSize = 18
closeBtn.BackgroundColor3 = Color3.fromRGB(200,50,50)
closeBtn.TextColor3 = Color3.new(1,1,1)
round(closeBtn,4)

local minBtn = Instance.new("TextButton", bar)
minBtn.Size = UDim2.new(0,30,0,30)
minBtn.Position = UDim2.new(1,-80,0,5)
minBtn.Text = "-"
minBtn.Font = Enum.Font.SourceSansBold
minBtn.TextSize = 22
minBtn.BackgroundColor3 = Color3.fromRGB(100,100,100)
minBtn.TextColor3 = Color3.new(1,1,1)
round(minBtn,4)

-- Tabs + Content
local tabsFrame = Instance.new("Frame", frame)
tabsFrame.Size = UDim2.new(0,140,1,-60)
tabsFrame.Position = UDim2.new(0,0,0,50)
tabsFrame.BackgroundTransparency = 1

local contentFrame = Instance.new("Frame", frame)
contentFrame.Size = UDim2.new(1,-140,1,-60)
contentFrame.Position = UDim2.new(0,140,0,50)
contentFrame.BackgroundTransparency = 1
enableDrag(contentFrame)

local tabNames = {"Mine","Spin Wheel","Auto Rewards","Eggs","Auto Win","Teleport"}
local tabButtons = {}

-- =========================
-- Mining Tab
-- =========================
local function buildMineTab()
    for _,v in pairs(contentFrame:GetChildren()) do v:Destroy() end

    local label = Instance.new("TextLabel", contentFrame)
    label.Size = UDim2.new(0.6,-10,0,30)
    label.Position = UDim2.new(0,10,0,10)
    label.BackgroundTransparency = 1
    label.Text = "Auto-Mine"
    label.TextColor3 = Color3.new(1,1,1)
    label.Font = Enum.Font.SourceSansBold
    label.TextSize = 18
    label.TextXAlignment = Enum.TextXAlignment.Left

    local mineBtn = Instance.new("TextButton", contentFrame)
    mineBtn.Size = UDim2.new(0.35,0,0,30)
    mineBtn.Position = UDim2.new(0.65,0,0,10)
    mineBtn.Text = "OFF"
    mineBtn.Font = Enum.Font.SourceSansBold
    mineBtn.TextSize = 18
    mineBtn.BackgroundColor3 = Color3.fromRGB(88,101,242)
    mineBtn.TextColor3 = Color3.new(1,1,1)
    round(mineBtn,6)

    local mining = false
    local interval = 0.1

    local function startMining()
        while mining do
            pcall(function()
                GameHandler:FireServer({{Info="Mine"}})
            end)
            task.wait(interval)
        end
    end

    mineBtn.MouseButton1Click:Connect(function()
        mining = not mining
        mineBtn.Text = mining and "ON" or "OFF"
        mineBtn.BackgroundColor3 = mining and Color3.fromRGB(0,170,0) or Color3.fromRGB(88,101,242)
        if mining then task.spawn(startMining) end
    end)
end

-- =========================
-- Spin Wheel Tab
-- =========================
local function buildSpinWheelTab()
    for _,v in pairs(contentFrame:GetChildren()) do v:Destroy() end
    local label = Instance.new("TextLabel", contentFrame)
    label.Size = UDim2.new(0.6,-10,0,30)
    label.Position = UDim2.new(0,10,0,10)
    label.BackgroundTransparency = 1
    label.Text = "Auto Spin Wheel"
    label.TextColor3 = Color3.new(1,1,1)
    label.Font = Enum.Font.SourceSansBold
    label.TextSize = 18
    label.TextXAlignment = Enum.TextXAlignment.Left

    local spinBtn = Instance.new("TextButton", contentFrame)
    spinBtn.Size = UDim2.new(0.35,0,0,30)
    spinBtn.Position = UDim2.new(0.65,0,0,10)
    spinBtn.Text = "OFF"
    spinBtn.Font = Enum.Font.SourceSansBold
    spinBtn.TextSize = 18
    spinBtn.BackgroundColor3 = Color3.fromRGB(88,101,242)
    spinBtn.TextColor3 = Color3.new(1,1,1)
    round(spinBtn,6)

    local spinning = false
    local interval = 1

    local function startSpinning()
        while spinning do
            pcall(function()
                WheelRemote:InvokeServer()
            end)
            task.wait(interval)
        end
    end

    spinBtn.MouseButton1Click:Connect(function()
        spinning = not spinning
        spinBtn.Text = spinning and "ON" or "OFF"
        spinBtn.BackgroundColor3 = spinning and Color3.fromRGB(0,170,0) or Color3.fromRGB(88,101,242)
        if spinning then task.spawn(startSpinning) end
    end)
end

-- =========================
-- Auto Rewards Tab
-- =========================
local function buildRewardsTab()
    for _,v in pairs(contentFrame:GetChildren()) do v:Destroy() end
    local label = Instance.new("TextLabel", contentFrame)
    label.Size = UDim2.new(0.6,-10,0,30)
    label.Position = UDim2.new(0,10,0,10)
    label.BackgroundTransparency = 1
    label.Text = "Auto Claim Rewards"
    label.TextColor3 = Color3.new(1,1,1)
    label.Font = Enum.Font.SourceSansBold
    label.TextSize = 18
    label.TextXAlignment = Enum.TextXAlignment.Left

    local rewardBtn = Instance.new("TextButton", contentFrame)
    rewardBtn.Size = UDim2.new(0.35,0,0,30)
    rewardBtn.Position = UDim2.new(0.65,0,0,10)
    rewardBtn.Text = "OFF"
    rewardBtn.Font = Enum.Font.SourceSansBold
    rewardBtn.TextSize = 18
    rewardBtn.BackgroundColor3 = Color3.fromRGB(88,101,242)
    rewardBtn.TextColor3 = Color3.new(1,1,1)
    round(rewardBtn,6)

    local claiming = false
    local interval = 0.5

    local function startClaiming()
        while claiming do
            for i=1,9 do
                pcall(function()
                    PlaytimeRemote:FireServer({{Info="ClaimReward",Reward=i}})
                end)
            end
            task.wait(interval)
        end
    end

    rewardBtn.MouseButton1Click:Connect(function()
        claiming = not claiming
        rewardBtn.Text = claiming and "ON" or "OFF"
        rewardBtn.BackgroundColor3 = claiming and Color3.fromRGB(0,170,0) or Color3.fromRGB(88,101,242)
        if claiming then task.spawn(startClaiming) end
    end)
end

-- =========================
-- Eggs Tab
-- =========================
-- Auto-Buy Eggs Tab
local function buildEggsTab()
    local function buildEggsTab()
    for _,v in pairs(contentFrame:GetChildren()) do v:Destroy() end

    local label = Instance.new("TextLabel", contentFrame)
    label.Size = UDim2.new(0.6,-10,0,30)
    label.Position = UDim2.new(0,10,0,10)
    label.BackgroundTransparency = 1
    label.Text = "Auto-Buy Eggs"
    label.TextColor3 = Color3.new(1,1,1)
    label.Font = Enum.Font.SourceSansBold
    label.TextSize = 18
    label.TextXAlignment = Enum.TextXAlignment.Left

    -- ScrollingFrame
    local scrollFrame = Instance.new("ScrollingFrame", contentFrame)
    scrollFrame.Size = UDim2.new(1,-20,1,-50)
    scrollFrame.Position = UDim2.new(0,10,0,50)
    scrollFrame.CanvasSize = UDim2.new(0,0,0,0)
    scrollFrame.ScrollBarThickness = 10
    scrollFrame.BackgroundTransparency = 0.8
    scrollFrame.BackgroundColor3 = Color3.fromRGB(30,30,30)
    round(scrollFrame, 8)

    local uiList = Instance.new("UIListLayout", scrollFrame)
    uiList.SortOrder = Enum.SortOrder.LayoutOrder
    uiList.Padding = UDim.new(0,5)

    -- Colors per world
    local worldColors = {
        Color3.fromRGB(255,100,100),   -- World 1
        Color3.fromRGB(100,255,100),   -- World 2
        Color3.fromRGB(100,100,255),   -- World 3
        Color3.fromRGB(255,255,100),   -- World 4
        Color3.fromRGB(255,100,255),   -- World 5
    }

    -- Create 15 buttons, 3 eggs per world
    for world = 1,5 do
        for egg = 1,3 do
            local eggName = "World "..world.." Egg "..egg
            local btn = Instance.new("TextButton", scrollFrame)
            btn.Size = UDim2.new(1,0,0,30)
            btn.Text = "OFF - "..eggName
            btn.Font = Enum.Font.SourceSansBold
            btn.TextSize = 16
            btn.TextColor3 = Color3.new(1,1,1)
            btn.BackgroundColor3 = worldColors[world]
            round(btn,6)

            local buying = false
            btn.MouseButton1Click:Connect(function()
                buying = not buying
                btn.Text = (buying and "ON - " or "OFF - ")..eggName
                btn.BackgroundColor3 = buying and Color3.fromRGB(0,170,0) or worldColors[world]

                if buying then
                    task.spawn(function()
                        while buying do
                            local args = {{Info="PurchaseEgg", Egg=eggName}}
                            pcall(function()
                                game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("Eggs"):InvokeServer(unpack(args))
                            end)
                            task.wait(0.15)
                        end
                    end)
                end
            end)
        end
    end

    -- Update canvas size
    scrollFrame.CanvasSize = UDim2.new(0,0,0,uiList.AbsoluteContentSize.Y + 10)
end


-- =========================
-- Teleport Tab
-- =========================
local function buildTeleportTab()
    for _,v in pairs(contentFrame:GetChildren()) do v:Destroy() end
    local label = Instance.new("TextLabel", contentFrame)
    label.Size = UDim2.new(0.6,-10,0,30)
    label.Position = UDim2.new(0,10,0,10)
    label.BackgroundTransparency = 1
    label.Text = "Teleport Worlds"
    label.TextColor3 = Color3.new(1,1,1)
    label.Font = Enum.Font.SourceSansBold
    label.TextSize = 18
    label.TextXAlignment = Enum.TextXAlignment.Left

    local worlds = {1,2,3,4,5}
    local teleportDropdown = Instance.new("TextButton", contentFrame)
    teleportDropdown.Size = UDim2.new(0.35,0,0,30)
    teleportDropdown.Position = UDim2.new(0.65,0,0,10)
    teleportDropdown.Text = "Select World"
    teleportDropdown.Font = Enum.Font.SourceSansBold
    teleportDropdown.TextSize = 18
    teleportDropdown.BackgroundColor3 = Color3.fromRGB(88,101,242)
    teleportDropdown.TextColor3 = Color3.new(1,1,1)
    round(teleportDropdown,6)

    local selectedWorld = worlds[1]
    local dropdownOpen = false
    local dropdownFrame = Instance.new("Frame", contentFrame)
    dropdownFrame.Size = UDim2.new(0.35,0,0,0)
    dropdownFrame.Position = UDim2.new(0.65,0,0,40)
    dropdownFrame.BackgroundColor3 = Color3.fromRGB(30,30,30)
    round(dropdownFrame,6)
    dropdownFrame.ClipsDescendants = true

    for i,world in ipairs(worlds) do
        local b = Instance.new("TextButton", dropdownFrame)
        b.Size = UDim2.new(1,0,0,30)
        b.Position = UDim2.new(0,0,0,(i-1)*30)
        b.Text = "World "..world
        b.Font = Enum.Font.SourceSans
        b.TextSize = 16
        b.BackgroundColor3 = Color3.fromRGB(50,50,50)
        b.TextColor3 = Color3.new(1,1,1)
        round(b,4)
        b.MouseButton1Click:Connect(function()
            selectedWorld = world
            teleportDropdown.Text = "World "..world
            dropdownFrame.Size = UDim2.new(0.35,0,0,0)
            dropdownOpen = false
            GameHandler:FireServer({{Info="SwitchWorld",World=selectedWorld}})
        end)
    end

    teleportDropdown.MouseButton1Click:Connect(function()
        dropdownOpen = not dropdownOpen
        dropdownFrame.Size = dropdownOpen and UDim2.new(0.35,0,0,#worlds*30) or UDim2.new(0.35,0,0,0)
    end)
end

-- =========================
-- Tab Switch
-- =========================
local function selectTab(idx)
    for i,btn in ipairs(tabButtons) do
        btn.BackgroundColor3 = (i==idx) and Color3.fromRGB(80,80,80) or Color3.fromRGB(50,50,50)
    end
    if idx == 1 then buildMineTab()
    elseif idx == 2 then buildSpinWheelTab()
    elseif idx == 3 then buildRewardsTab()
    elseif idx == 4 then buildEggsTab()
    elseif idx == 5 then buildAutoWinTab()
    elseif idx == 6 then buildTeleportTab()
    end
end

-- Create Tab Buttons
for i,name in ipairs(tabNames) do
    local btn = Instance.new("TextButton", tabsFrame)
    btn.Size = UDim2.new(1,0,0,40)
    btn.Position = UDim2.new(0,0,0,(i-1)*45)
    btn.Text = name
    btn.Font = Enum.Font.SourceSansBold
    btn.TextSize = 20
    round(btn,6)
    btn.BackgroundColor3 = (i==1 and Color3.fromRGB(80,80,80) or Color3.fromRGB(50,50,50))
    btn.TextColor3 = Color3.new(1,1,1)
    btn.MouseButton1Click:Connect(function() selectTab(i) end)
    table.insert(tabButtons, btn)
end

-- Select first tab
selectTab(1)

-- Minimize + Close
local minimized = false
minBtn.MouseButton1Click:Connect(function()
    minimized = not minimized
    if minimized then
        tween(frame, { Size = MINIMIZED_SZ })
    else
        tween(frame, { Size = HUB_SZ })
    end
    tabsFrame.Visible = not minimized
    contentFrame.Visible = not minimized
end)

closeBtn.MouseButton1Click:Connect(function()
    tween(frame, { Size = CLOSED_SZ }).Completed:Wait()
    screenGui:Destroy()
end)
